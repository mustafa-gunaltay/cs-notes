

# 1) 



## âš™ï¸ **4ï¸âƒ£ OperatÃ¶rler ve Pipe Zinciri**

### ğŸ“˜ 1. Kavramsal TanÄ±m

**OperatÃ¶rler (Operators)**, bir **Observable**â€™dan gelen akÄ±ÅŸÄ± **dÃ¶nÃ¼ÅŸtÃ¼rmek, filtrelemek veya birleÅŸtirmek** iÃ§in kullanÄ±lÄ±r.
RxJSâ€™te yÃ¼zlerce operatÃ¶r vardÄ±r ama hepsi aynÄ± felsefeyi paylaÅŸÄ±r:

> â€œVeri akarken Ã¼zerinde bir iÅŸlem yap.â€

BÃ¼tÃ¼n bu operatÃ¶rler `pipe()` fonksiyonu iÃ§inde **zincir** (pipeline) ÅŸeklinde baÄŸlanÄ±r.

```ts
stream.pipe(
  map(x => x * 2),
  filter(x => x > 5)
)
```

ğŸ’¡ **`pipe()`**, â€œakÄ±ÅŸ Ã¼zerinde bir boru hattÄ± kurâ€ anlamÄ±na gelir.
Her operatÃ¶r bir **yeni stream** dÃ¶ndÃ¼rÃ¼r (immutable yapÄ±).
Yani orijinal akÄ±ÅŸ bozulmaz, sadece yeni bir formda akmaya devam eder.

---

### âš™ï¸ 2. Basit Ã–rnek

```ts
import { from } from 'rxjs';
import { map, filter } from 'rxjs/operators';

const numbers$ = from([1, 2, 3, 4, 5]);

numbers$
  .pipe(
    map(x => x * 10),        // Her deÄŸeri 10 ile Ã§arp
    filter(x => x >= 30)     // 30'dan kÃ¼Ã§Ã¼kleri Ã§Ä±kar
  )
  .subscribe(result => console.log(result));
```

ğŸ§  **AkÄ±ÅŸÄ±n MantÄ±ÄŸÄ±:**

```
1 â†’ 10  âŒ
2 â†’ 20  âŒ
3 â†’ 30  âœ…
4 â†’ 40  âœ…
5 â†’ 50  âœ…
```

**Ã‡Ä±ktÄ±:**

```
30
40
50
```

---

### ğŸ§© 3. OperatÃ¶r TÃ¼rleri (GruplandÄ±rÄ±lmÄ±ÅŸ)

| Kategori                           | Ã–rnek OperatÃ¶rler                               | AÃ§Ä±klama                            |
| ---------------------------------- | ----------------------------------------------- | ----------------------------------- |
| **DÃ¶nÃ¼ÅŸtÃ¼rme (Transformation)**    | `map`, `mapTo`, `pluck`                         | DeÄŸeri baÅŸka bir biÃ§ime dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r  |
| **Filtreleme (Filtering)**         | `filter`, `take`, `first`, `debounceTime`       | AkÄ±ÅŸtaki bazÄ± deÄŸerleri atar        |
| **BirleÅŸtirme (Combination)**      | `merge`, `combineLatest`, `concat`, `switchMap` | Birden fazla streamâ€™i birleÅŸtirir   |
| **Zaman (Time-based)**             | `delay`, `interval`, `throttleTime`             | Zaman bazlÄ± kontrol saÄŸlar          |
| **Hata YÃ¶netimi (Error Handling)** | `catchError`, `retry`                           | HatalarÄ± yakalar veya yeniden dener |

---

### â›“ï¸ 4. `pipe()` MantÄ±ÄŸÄ±

`pipe()` fonksiyonu, operatÃ¶rleri **zincirleme (chaining)** bir ÅŸekilde Ã§alÄ±ÅŸtÄ±rÄ±r.
Her operatÃ¶r, bir **Observable** alÄ±r ve **yeni bir Observable** dÃ¶ndÃ¼rÃ¼r.

```ts
observable.pipe(op1(), op2(), op3());
```

Bu yapÄ± fonksiyonel programlamadaki **â€œcomposition (bileÅŸim)â€** mantÄ±ÄŸÄ±na Ã§ok benzer.
Kodun â€œnasÄ±lâ€ deÄŸil â€œne yapÄ±lacaÄŸÄ±nÄ±â€ anlattÄ±ÄŸÄ± **deklaratif (declarative)** bir tarzdÄ±r.

---

### âš¡ 5. Ã–rnek â€” combineLatest ile Ã‡oklu AkÄ±ÅŸ

```ts
import { combineLatest, of } from 'rxjs';
import { map } from 'rxjs/operators';

const names$ = of('Alice', 'Bob');
const ages$ = of(25, 30);

combineLatest([names$, ages$])
  .pipe(map(([name, age]) => `${name} is ${age} years old`))
  .subscribe(console.log);
```

ğŸ§  **AÃ§Ä±klama:**
`combineLatest`, iki streamâ€™in **son yayÄ±lan deÄŸerlerini** birleÅŸtirir.
Veri, â€œsenkronâ€ deÄŸil â€œreaktifâ€ olarak akÄ±ÅŸa baÄŸlÄ± ÅŸekilde gelir.

---

### âœ… 6. Best Practice

| Prensip                                                          | AÃ§Ä±klama                                                              |
| ---------------------------------------------------------------- | --------------------------------------------------------------------- |
| **1. Side-effectâ€™leri pipe dÄ±ÅŸÄ±na Ã§Ä±kar**                        | Pipe iÃ§inde `console.log` veya HTTP Ã§aÄŸrÄ±sÄ± gibi yan etkiler olmamalÄ± |
| **2. OperatÃ¶rleri fonksiyonel dÃ¼ÅŸÃ¼n**                            | AkÄ±ÅŸÄ± *nasÄ±l* dÃ¶nÃ¼ÅŸtÃ¼rdÃ¼ÄŸÃ¼nÃ¼ deÄŸil, *neye* dÃ¶nÃ¼ÅŸtÃ¼rdÃ¼ÄŸÃ¼nÃ¼ tanÄ±mla     |
| **3. Zinciri kÄ±sa tut**                                          | Uzun pipe zincirleri kodu okunmaz hale getirir                        |
| **4. combineLatest veya switchMapâ€™i async durumlar iÃ§in kullan** | Paralel veya dinamik akÄ±ÅŸlarÄ± yÃ¶netmede gÃ¼Ã§lÃ¼dÃ¼r                      |

---

### ğŸ’¡ Soyutlama CÃ¼mlesi

> â€œReaktif sistemde veri durmaz, akar.
> `pipe()` akÄ±ÅŸÄ± biÃ§imlendirir, operatÃ¶rler akÄ±ÅŸa anlam katar.
> Her dÃ¶nÃ¼ÅŸÃ¼m yeni bir stream Ã¼retir â€” bu, sistemin fonksiyonel ve yan etkisiz kalmasÄ±nÄ± saÄŸlar.â€

---



# 2) Gercek Hayat Ornegi

```ts
deleteCategory(id: number): Observable<void> {
    return this.http.delete<void>(`${this.apiUrl}/${id}`, {
      // 1) Angularâ€™Ä±n HttpClient servisi varsayÄ±lan olarak yalnÄ±zca response bodyâ€™yi 
      // dÃ¶ndÃ¼rÃ¼r. HTTP status code, headers gibi meta bilgiler gelmez.
      // 2) observe: 'response' kullanarak sadece bodyâ€™yi deÄŸil,
      // tÃ¼m HttpResponse objesini alÄ±yoruz
      observe: 'response'
    }).pipe(
      map(response => {
        this.logger.debug('Delete Response', { status: response.status, categoryId: id }, 'CategoryService');
        
        // 204 No Content = BaÅŸarÄ±lÄ± silme
        if (response.status === 204) {
          this.logger.info('Kategori baÅŸarÄ±yla silindi (204 No Content)', { categoryId: id }, 'CategoryService');
          return; // void dÃ¶nÃ¼yoruz
        }
        
        // 200 OK da olabilir (bazÄ± backend'ler 200 dÃ¶ner)
        if (response.status === 200) {
          this.logger.info('Kategori baÅŸarÄ±yla silindi (200 OK)', { categoryId: id }, 'CategoryService');
          return;
        }
        
        // Beklenmeyen durum
        this.logger.warn('Beklenmeyen status code', { status: response.status, categoryId: id }, 'CategoryService');
        return;
      }),
      catchError(error => {
        this.logger.error('Kategori silme hatasÄ±', { error, categoryId: id, status: error.status }, 'CategoryService');
        
        // 404 Not Found - Kategori bulunamadÄ±
        if (error.status === 404) {
          // Backend BaseResponse dÃ¶nÃ¼yor
          if (error.error && !error.error.isSuccess) {
            const errorMessage = BaseResponseHelper.getAllErrors(error.error);
            this.logger.error('Backend hatasÄ±', { errorMessage }, 'CategoryService');
            throw new Error(errorMessage || 'Kategori bulunamadÄ±');
          }
          throw new Error('Kategori bulunamadÄ±');
        }
        
        // 400 Bad Request - GeÃ§ersiz ID
        if (error.status === 400) {
          throw new Error('GeÃ§ersiz kategori ID\'si');
        }
        
        // 401 Unauthorized - Token geÃ§ersiz
        if (error.status === 401) {
          throw new Error('Yetkilendirme hatasÄ±. LÃ¼tfen tekrar giriÅŸ yapÄ±n.');
        }
        
        // 403 Forbidden - EriÅŸim izni yok
        if (error.status === 403) {
          throw new Error('Bu kategoriyi silme yetkiniz yok.');
        }
        
        // DiÄŸer hatalar
        return throwError(() => error);
      })
    );
  }
```


## ğŸ§© HTTP Response & `pipe()` AkÄ±ÅŸÄ± (Angular + RxJS)

### **1ï¸âƒ£ `observe: 'response'` Nedir?**

Angular `HttpClient` varsayÄ±lan olarak sadece **response body**â€™yi dÃ¶ndÃ¼rÃ¼r.
Ancak aÅŸaÄŸÄ±daki gibi kullanÄ±rsan:

```ts
this.http.delete(`${this.apiUrl}/${id}`, { observe: 'response' })
```

artÄ±k yalnÄ±zca body deÄŸil, tÃ¼m **HttpResponse** objesini alÄ±rsÄ±n:

```ts
{
  body: ...,
  status: 204,
  headers: {...},
  url: "https://api.example.com/categories/1"
}
```

> ğŸ¯ `observe: 'response'` â†’ **status**, **headers** ve **body** bilgilerine aynÄ± anda eriÅŸebilmeni saÄŸlar.

---

### **2ï¸âƒ£ `map(response => ...)` ile BaÄŸlantÄ±**

`observe: 'response'` sayesinde artÄ±k `pipe(map(...))` iÃ§inde `response` bir
**HttpResponse objesi** olur (sadece body deÄŸil).

```ts
map(response => {
  if (response.status === 204) {
    this.logger.info('Kategori baÅŸarÄ±yla silindi');
    return; // void dÃ¶nÃ¼yor
  }
})
```

> Yani `map()` burada `HttpResponse â†’ void` dÃ¶nÃ¼ÅŸÃ¼mÃ¼ yapÄ±yor.
> Bu bir â€œdeÄŸer dÃ¶nÃ¼ÅŸÃ¼mÃ¼â€dÃ¼r, ama `status` kontrolÃ¼ ve loglama eklenmiÅŸtir.

---

### **3ï¸âƒ£ `map()` ve DÃ¶nÃ¼ÅŸtÃ¼rme MantÄ±ÄŸÄ±**

`map()` tipik olarak bir deÄŸeri baÅŸka bir deÄŸere dÃ¶nÃ¼ÅŸtÃ¼rmek iÃ§in kullanÄ±lÄ±r.
Bu Ã¶rnekte dÃ¶nÃ¼ÅŸÃ¼m ÅŸu ÅŸekilde gerÃ§ekleÅŸiyor:

```
HTTP Response (HttpResponse<T>)
     â†“ map()
void (iÅŸlenmiÅŸ sonuÃ§)
```

Yani `map()` burada **veri dÃ¶nÃ¼ÅŸtÃ¼rmek yerine** â€œiÅŸlenmiÅŸ durumaâ€ getiriyor
(loglama + `void` dÃ¶nÃ¼ÅŸ).

---

### **4ï¸âƒ£ `pipe()`â€™Ä±n RolÃ¼**

`pipe()` â†’ Bir **reaktif akÄ±ÅŸ boru hattÄ±** kurar.
Her operatÃ¶r (`map`, `catchError` vb.) akÄ±ÅŸÄ± iÅŸler ve **yeni bir Observable** dÃ¶ndÃ¼rÃ¼r:

```ts
this.http.delete(url, { observe: 'response' })
  .pipe(
    map(response => ...),
    catchError(error => ...)
  )
  .subscribe(...)
```

| OperatÃ¶r       | Ä°ÅŸlevi                            |
| -------------- | --------------------------------- |
| `map()`        | Responseâ€™u iÅŸler / dÃ¶nÃ¼ÅŸtÃ¼rÃ¼r     |
| `catchError()` | HatalarÄ± yakalar ve Ã¶zelleÅŸtirir  |
| `subscribe()`  | Component tarafÄ±nda sonucu dinler |

---

### **5ï¸âƒ£ `observe` ile `map` ArasÄ±ndaki Ä°liÅŸki**

| Alan                  | AmacÄ±                                                     | Etki AlanÄ±        |
| --------------------- | --------------------------------------------------------- | ----------------- |
| `observe: 'response'` | Angularâ€™Ä±n `HttpClient`â€™ine tam yanÄ±t dÃ¶ndÃ¼rmesini sÃ¶yler | HTTP KatmanÄ±      |
| `map(response => â€¦)`  | Bu yanÄ±tÄ± uygulama seviyesinde iÅŸler                      | RxJS AkÄ±ÅŸ KatmanÄ± |

---

